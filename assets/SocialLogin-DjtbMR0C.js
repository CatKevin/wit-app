import{b8 as Ye,aw as e,ax as h,az as g,b9 as Qe,aB as oe,aI as A,ba as Q,aE as le,as as i,bb as te,b7 as Be,bc as Ke,bd as Ze,ay as se,be as Je,bf as J,bg as Te,bh as X,aV as ee,bi as xe,bj as Xe,aK as fe,aD as et,bk as ze,bl as tt,bm as nt,bn as Me,bo as it,bp as at,bq as we,aY as rt,br as lt}from"./index-D5pZEnR3.js";import ot from"./AllWalletsUI-DffqcgPg.js";import{hasStoredPasskey as st}from"./passkeys-CKvh7qtP.js";function ct(){return Ye("useAddConnectedWallet").addConnectedWallet}function Se(t){return e.jsxs(h,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(Qe,{size:oe["3xl"]})}),e.jsx(g,{y:"lg"}),e.jsx(A,{center:!0,color:"primaryText",size:"md",children:t.title}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Q,{fullWidth:!0,onClick:t.onTryAgain,variant:"accent",children:"Try Again"})]})}function be(t){return e.jsxs(h,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsxs(h,{center:"x",flex:"row",style:{position:"relative"},children:[e.jsx(le,{color:"accentText",size:"4xl"}),e.jsx(h,{color:"accentText",style:{left:"50%",position:"absolute",top:"50%",transform:"translate(-50%, -50%)"},children:t.icon})]}),e.jsx(g,{y:"xl"}),e.jsx(A,{center:!0,color:"primaryText",size:"lg",children:t.title}),e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,multiline:!0,children:t.subtitle}),e.jsx(g,{y:"xxl"}),e.jsx(g,{y:"xxl"})]})}function Ot(t){var b;const{wallet:n,done:a}=t,s=ct(),r=i.useRef(void 0),[u,x]=i.useState("selecting"),[p,m]=i.useState(),[S,d]=i.useState(!1),k=te(n)?{id:n.id,partnerId:(b=n.getConfig())==null?void 0:b.partnerId}:void 0,v=()=>{x("selecting"),r.current=void 0,t.onBack()};async function w(y){x("loading"),m(void 0),r.current=y;try{t.isLinking?await J({chain:t.chain||n.getChain()||Te(1),client:t.client,ecosystem:k,strategy:"wallet",wallet:y}):await n.connect({chain:t.chain||y.getChain()||Te(1),client:t.client,strategy:"wallet",wallet:y}),s(y),a()}catch(f){m(f instanceof Error?f.message:"Unknown error"),x("error")}}return r.current?e.jsxs(h,{animate:"fadein",flex:"column",fullHeight:!0,children:[e.jsx(h,{p:"lg",children:e.jsx(se,{onBack:v,title:t.isLinking?t.inAppLocale.linkWallet:t.inAppLocale.signInWithWallet})}),e.jsx(h,{center:"y",expand:!0,flex:"column",px:t.size==="wide"?"xxl":"lg",children:e.jsx("div",{children:u==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:()=>{if(!r.current)throw new Error("Failed to connect to unknown wallet");w(r.current)},title:p||"Failed to Login"}),e.jsx(g,{y:"lg"})]}):e.jsx(be,{icon:e.jsx(Je,{client:t.client,id:r.current.id??"",size:oe.xl}),subtitle:"A pop-up prompt will appear to sign-in and verify your wallet",title:"Sign in with your wallet"})})})]}):S?e.jsx(i.Suspense,{fallback:e.jsx(Be,{}),children:e.jsx(ot,{client:t.client,connectLocale:t.locale,disableSelectionDataReset:!0,onBack:()=>d(!1),onSelect:async y=>{w(y),d(!1)},recommendedWallets:void 0,size:t.size})}):e.jsx(Ke,{chain:n.getChain(),chains:[],client:t.client,connectLocale:t.locale,disableSelectionDataReset:!0,done:()=>{},goBack:v,hideHeader:!1,meta:t.meta||{},modalHeader:{onBack:v,title:t.isLinking?t.inAppLocale.linkWallet:t.inAppLocale.signInWithWallet},onShowAll:()=>{d(!0)},recommendedWallets:void 0,selectWallet:async y=>{w(y)},setModalVisibility:()=>{},showAllWallets:!0,size:t.size,title:t.locale.connectAWallet,walletConnect:t.walletConnect,walletIdsToHide:["inApp"],wallets:Ze()})}function Dt(t){var v;const n=t.locale,a=n.socialLoginScreen,[s,r]=i.useState(void 0),{done:u,wallet:x}=t,[p,m]=i.useState("connecting"),S=async()=>{var b,y;const w={client:t.client,ecosystem:te(x)?{id:x.id,partnerId:(b=x.getConfig())==null?void 0:b.partnerId}:void 0,strategy:"guest"};try{await x.connect(w),await X("guest",ee),m("connected"),u()}catch(f){m("error"),f instanceof Error&&((y=f==null?void 0:f.message)!=null&&y.includes("PAYMENT_METHOD_REQUIRED"))&&r(n.maxAccountsExceeded),console.error("Error generating guest account",f)}},d=(v=t.state)==null?void 0:v.guestLogin,k=i.useRef(!1);return i.useEffect(()=>{k.current||d&&(k.current=!0,m("connecting"),d.connectionPromise.then(()=>{u(),m("connected")}).catch(w=>{r(w.message),m("error")}))},[u,d]),e.jsx(h,{animate:"fadein",flex:"column",fullHeight:!0,className:"tw-guest-login-screen",children:e.jsxs(h,{expand:!0,flex:"column",p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(se,{onBack:t.goBack,title:a.title}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(h,{center:"both",expand:!0,flex:"column",style:{minHeight:"250px",textAlign:"center"},children:[p!=="error"&&e.jsxs(h,{animate:"fadein",children:[e.jsx(A,{center:!0,color:"primaryText",multiline:!0,style:{maxWidth:"250px"},children:"Generating your guest account"}),e.jsx(g,{y:"xl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(le,{color:"accentText",size:"lg"})}),e.jsx(g,{y:"xxl"})]}),p==="error"&&e.jsxs(h,{animate:"fadein",children:[s?e.jsx(A,{center:!0,color:"danger",children:s}):e.jsx(A,{color:"danger",children:a.failed}),e.jsx(g,{y:"lg"}),e.jsx(Q,{onClick:S,variant:"primary",children:a.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}const ve=xe({animation:`${Xe} 0.15s ease-in`});var ut=Object.defineProperty,dt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertySymbols,Oe=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,Re=(t,n,a)=>n in t?ut(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,xt=(t,n)=>{for(var a in n||(n={}))Oe.call(n,a)&&Re(t,a,n[a]);if(ge)for(var a of ge(n))De.call(n,a)&&Re(t,a,n[a]);return t},ft=(t,n)=>dt(t,gt(n)),ht=(t,n)=>{var a={};for(var s in t)Oe.call(t,s)&&n.indexOf(s)<0&&(a[s]=t[s]);if(t!=null&&ge)for(var s of ge(t))n.indexOf(s)<0&&De.call(t,s)&&(a[s]=t[s]);return a};function mt(t){let n=setTimeout(t,0),a=setTimeout(t,10),s=setTimeout(t,50);return[n,a,s]}function yt(t){let n=i.useRef();return i.useEffect(()=>{n.current=t}),n.current}var pt=18,Fe=40,jt=`${Fe}px`,vt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function wt({containerRef:t,inputRef:n,pushPasswordManagerStrategy:a,isFocused:s}){let[r,u]=i.useState(!1),[x,p]=i.useState(!1),[m,S]=i.useState(!1),d=i.useMemo(()=>a==="none"?!1:(a==="increase-width"||a==="experimental-no-flickering")&&r&&x,[r,x,a]),k=i.useCallback(()=>{let v=t.current,w=n.current;if(!v||!w||m||a==="none")return;let b=v,y=b.getBoundingClientRect().left+b.offsetWidth,f=b.getBoundingClientRect().top+b.offsetHeight/2,j=y-pt,O=f;document.querySelectorAll(vt).length===0&&document.elementFromPoint(j,O)===v||(u(!0),S(!0))},[t,n,m,a]);return i.useEffect(()=>{let v=t.current;if(!v||a==="none")return;function w(){let y=window.innerWidth-v.getBoundingClientRect().right;p(y>=Fe)}w();let b=setInterval(w,1e3);return()=>{clearInterval(b)}},[t,a]),i.useEffect(()=>{let v=s||document.activeElement===n.current;if(a==="none"||!v)return;let w=setTimeout(k,0),b=setTimeout(k,2e3),y=setTimeout(k,5e3),f=setTimeout(()=>{S(!0)},6e3);return()=>{clearTimeout(w),clearTimeout(b),clearTimeout(y),clearTimeout(f)}},[n,s,a,k]),{hasPWMBadge:r,willPushPWMBadge:d,PWM_BADGE_SPACE_WIDTH:jt}}var St=i.createContext({}),_e=i.forwardRef((t,n)=>{var a=t,{value:s,onChange:r,maxLength:u,textAlign:x="left",pattern:p,placeholder:m,inputMode:S="numeric",onComplete:d,pushPasswordManagerStrategy:k="increase-width",pasteTransformer:v,containerClassName:w,noScriptCSSFallback:b=bt,render:y,children:f}=a,j=ht(a,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),O,F,$,G,L;let[B,ce]=i.useState(typeof j.defaultValue=="string"?j.defaultValue:""),o=s??B,P=yt(o),I=i.useCallback(l=>{r==null||r(l),ce(l)},[r]),D=i.useMemo(()=>p?typeof p=="string"?new RegExp(p):p:null,[p]),C=i.useRef(null),he=i.useRef(null),me=i.useRef({value:o,onChange:I,isIOS:typeof window<"u"&&((F=(O=window==null?void 0:window.CSS)==null?void 0:O.supports)==null?void 0:F.call(O,"-webkit-touch-callout","none"))}),ue=i.useRef({prev:[($=C.current)==null?void 0:$.selectionStart,(G=C.current)==null?void 0:G.selectionEnd,(L=C.current)==null?void 0:L.selectionDirection]});i.useImperativeHandle(n,()=>C.current,[]),i.useEffect(()=>{let l=C.current,c=he.current;if(!l||!c)return;me.current.value!==l.value&&me.current.onChange(l.value),ue.current.prev=[l.selectionStart,l.selectionEnd,l.selectionDirection];function W(){if(document.activeElement!==l){ie(null),ae(null);return}let E=l.selectionStart,T=l.selectionEnd,de=l.selectionDirection,z=l.maxLength,V=l.value,_=ue.current.prev,H=-1,N=-1,q;if(V.length!==0&&E!==null&&T!==null){let Ue=E===T,Ve=E===V.length&&V.length<z;if(Ue&&!Ve){let Y=E;if(Y===0)H=0,N=1,q="forward";else if(Y===z)H=Y-1,N=Y,q="backward";else if(z>1&&V.length>1){let je=0;if(_[0]!==null&&_[1]!==null){q=Y<_[1]?"backward":"forward";let qe=_[0]===_[1]&&_[0]<z;q==="backward"&&!qe&&(je=-1)}H=je+Y,N=je+Y+1}}H!==-1&&N!==-1&&H!==N&&C.current.setSelectionRange(H,N,q)}let We=H!==-1?H:E,Pe=N!==-1?N:T,Ge=q??de;ie(We),ae(Pe),ue.current.prev=[We,Pe,Ge]}if(document.addEventListener("selectionchange",W,{capture:!0}),W(),document.activeElement===l&&ye(!0),!document.getElementById("input-otp-style")){let E=document.createElement("style");if(E.id="input-otp-style",document.head.appendChild(E),E.sheet){let T="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";re(E.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),re(E.sheet,`[data-input-otp]:autofill { ${T} }`),re(E.sheet,`[data-input-otp]:-webkit-autofill { ${T} }`),re(E.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),re(E.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let M=()=>{c&&c.style.setProperty("--root-height",`${l.clientHeight}px`)};M();let R=new ResizeObserver(M);return R.observe(l),()=>{document.removeEventListener("selectionchange",W,{capture:!0}),R.disconnect()}},[]);let[ke,Ee]=i.useState(!1),[ne,ye]=i.useState(!1),[U,ie]=i.useState(null),[K,ae]=i.useState(null);i.useEffect(()=>{mt(()=>{var l,c,W,M;(l=C.current)==null||l.dispatchEvent(new Event("input"));let R=(c=C.current)==null?void 0:c.selectionStart,E=(W=C.current)==null?void 0:W.selectionEnd,T=(M=C.current)==null?void 0:M.selectionDirection;R!==null&&E!==null&&(ie(R),ae(E),ue.current.prev=[R,E,T])})},[o,ne]),i.useEffect(()=>{P!==void 0&&o!==P&&P.length<u&&o.length===u&&(d==null||d(o))},[u,d,P,o]);let Z=wt({containerRef:he,inputRef:C,pushPasswordManagerStrategy:k,isFocused:ne}),Ce=i.useCallback(l=>{let c=l.currentTarget.value.slice(0,u);if(c.length>0&&D&&!D.test(c)){l.preventDefault();return}typeof P=="string"&&c.length<P.length&&document.dispatchEvent(new Event("selectionchange")),I(c)},[u,I,P,D]),Ae=i.useCallback(()=>{var l;if(C.current){let c=Math.min(C.current.value.length,u-1),W=C.current.value.length;(l=C.current)==null||l.setSelectionRange(c,W),ie(c),ae(W)}ye(!0)},[u]),Le=i.useCallback(l=>{var c,W;let M=C.current;if(!v&&(!me.current.isIOS||!l.clipboardData||!M))return;let R=l.clipboardData.getData("text/plain"),E=v?v(R):R;l.preventDefault();let T=(c=C.current)==null?void 0:c.selectionStart,de=(W=C.current)==null?void 0:W.selectionEnd,z=(T!==de?o.slice(0,T)+E+o.slice(de):o.slice(0,T)+E+o.slice(T)).slice(0,u);if(z.length>0&&D&&!D.test(z))return;M.value=z,I(z);let V=Math.min(z.length,u-1),_=z.length;M.setSelectionRange(V,_),ie(V),ae(_)},[u,I,D,o]),He=i.useMemo(()=>({position:"relative",cursor:j.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[j.disabled]),Ie=i.useMemo(()=>({position:"absolute",inset:0,width:Z.willPushPWMBadge?`calc(100% + ${Z.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:Z.willPushPWMBadge?`inset(0 ${Z.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:x,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[Z.PWM_BADGE_SPACE_WIDTH,Z.willPushPWMBadge,x]),Ne=i.useMemo(()=>i.createElement("input",ft(xt({autoComplete:j.autoComplete||"one-time-code"},j),{"data-input-otp":!0,"data-input-otp-placeholder-shown":o.length===0||void 0,"data-input-otp-mss":U,"data-input-otp-mse":K,inputMode:S,pattern:D==null?void 0:D.source,"aria-placeholder":m,style:Ie,maxLength:u,value:o,ref:C,onPaste:l=>{var c;Le(l),(c=j.onPaste)==null||c.call(j,l)},onChange:Ce,onMouseOver:l=>{var c;Ee(!0),(c=j.onMouseOver)==null||c.call(j,l)},onMouseLeave:l=>{var c;Ee(!1),(c=j.onMouseLeave)==null||c.call(j,l)},onFocus:l=>{var c;Ae(),(c=j.onFocus)==null||c.call(j,l)},onBlur:l=>{var c;ye(!1),(c=j.onBlur)==null||c.call(j,l)}})),[Ce,Ae,Le,S,Ie,u,K,U,j,D==null?void 0:D.source,o]),pe=i.useMemo(()=>({slots:Array.from({length:u}).map((l,c)=>{var W;let M=ne&&U!==null&&K!==null&&(U===K&&c===U||c>=U&&c<K),R=o[c]!==void 0?o[c]:null,E=o[0]!==void 0?null:(W=m==null?void 0:m[c])!=null?W:null;return{char:R,placeholderChar:E,isActive:M,hasFakeCaret:M&&R===null}}),isFocused:ne,isHovering:!j.disabled&&ke}),[ne,ke,u,K,U,j.disabled,o]),$e=i.useMemo(()=>y?y(pe):i.createElement(St.Provider,{value:pe},f),[f,pe,y]);return i.createElement(i.Fragment,null,b!==null&&i.createElement("noscript",null,i.createElement("style",null,b)),i.createElement("div",{ref:he,"data-input-otp-container":!0,style:He,className:w},$e,i.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ne)))});_e.displayName="Input";function re(t,n){try{t.insertRule(n)}catch{console.error("input-otp could not insert CSS rule:",n)}}var bt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function kt(t){return e.jsx(Et,{className:"tw-otp-input-container",children:e.jsx(_e,{maxLength:6,onChange:n=>{t.setValue(n)},onComplete:()=>{t.onEnter()},render:({slots:n})=>e.jsx(h,{center:"both",flex:"row",gap:"xs",children:n.map((a,s)=>e.jsx(Ct,{...a,isInvalid:t.isInvalid},s))}),value:t.value})})}const Et=xe({"& input":{maxWidth:"100%"}});function Ct(t){return e.jsxs(It,{"data-active":t.isActive,"data-error":t.isInvalid,children:[t.char!==null&&e.jsx("div",{children:t.char}),t.hasFakeCaret&&e.jsx(Lt,{})]})}const At=nt`
  0%, 100% {
    opacity: 0;
  },
  50% {
    opacity: 1;
  }
  `,Lt=xe(t=>({"&::before":{backgroundColor:fe().colors.primaryText,content:"''",display:"block",height:"1em",width:"1.5px"},alignItems:"center",animation:`${At} 1s infinite`,display:"flex",inset:0,justifyContent:"center",pointerEvents:"none",position:"absolute"})),It=xe(t=>{const n=fe();return{"&[data-active='true']":{borderColor:n.colors.accentText},"&[data-error='true']":{borderColor:n.colors.danger},alignItems:"center",border:`2px solid ${n.colors.borderColor}`,borderRadius:tt.lg,boxSizing:"border-box",color:n.colors.primaryText,display:"flex",fontSize:ze.md,height:"40px",justifyContent:"center",padding:et.xs,position:"relative",textAlign:"center",transition:"color 200ms ease",width:"40px"}});function Ft(t){var ce;const{wallet:n,done:a,goBack:s,userInfo:r}=t,u=t.size==="wide",x=t.locale,[p,m]=i.useState(""),[S,d]=i.useState("idle"),[k,v]=i.useState(),[w,b]=i.useState({type:"sending"}),[y,f]=i.useState(0),j=te(n)?{id:n.id,partnerId:(ce=n.getConfig())==null?void 0:ce.partnerId}:void 0,[O]=i.useState("base"),F=i.useCallback(async()=>{m(""),d("idle"),b({type:"sending"});try{if("email"in r)await Me({client:t.client,ecosystem:j,email:r.email,strategy:"email"}),b({type:"sent"}),f(60);else if("phone"in r)await Me({client:t.client,ecosystem:j,phoneNumber:r.phone,strategy:"phone"}),b({type:"sent"}),f(60);else throw new Error("Invalid userInfo")}catch(o){console.error(o),d("idle"),b({type:"error",message:o instanceof Error?o.message:void 0})}},[t.client,r,j]);async function $(o){if("email"in r)await n.connect({chain:t.chain,client:t.client,email:r.email,strategy:"email",verificationCode:o}),await X("email",ee);else if("phone"in r)await n.connect({chain:t.chain,client:t.client,phoneNumber:r.phone,strategy:"phone",verificationCode:o}),await X("phone",ee);else throw new Error("Invalid userInfo")}async function G(o){"email"in r?await J({client:t.client,ecosystem:j,email:r.email,strategy:"email",verificationCode:o}):"phone"in r&&await J({client:t.client,ecosystem:j,phoneNumber:r.phone,strategy:"phone",verificationCode:o})}const L=async o=>{var P;if(o.length===6){d("verifying");try{t.isLinking?await G(o):await $(o),a(),d("valid")}catch(I){I instanceof Error&&((P=I==null?void 0:I.message)!=null&&P.includes("PAYMENT_METHOD_REQUIRED"))?d("payment_required"):I instanceof Error&&(I.message.toLowerCase().includes("link")||I.message.toLowerCase().includes("profile"))?(d("linking_error"),v(I.message)):d("invalid"),console.error("Authentication Error",I)}}},B=i.useRef(!1);return i.useEffect(()=>{B.current||(B.current=!0,F())},[F]),i.useEffect(()=>{if(y<=0)return;const o=setInterval(()=>{f(P=>P<=1?(clearInterval(o),0):P-1)},1e3);return()=>clearInterval(o)},[y]),O==="base"?e.jsxs(h,{animate:"fadein",flex:"column",fullHeight:!0,className:"tw-otp-login-screen",children:[e.jsx(h,{p:"lg",children:e.jsx(se,{onBack:s,title:x.signIn})}),e.jsx(h,{center:"y",expand:!0,flex:"column",children:e.jsxs("form",{onSubmit:o=>{o.preventDefault()},children:[e.jsxs(h,{center:"x",flex:"column",px:"lg",children:[!u&&e.jsx(g,{y:"xl"}),e.jsx(A,{className:"tw-screen-title",children:x.emailLoginScreen.enterCodeSendTo}),e.jsx(g,{y:"sm"}),e.jsx(A,{color:"primaryText",children:"email"in r?r.email:r.phone}),e.jsx(g,{y:"xl"})]}),e.jsx(kt,{digits:6,isInvalid:S==="invalid",onEnter:()=>{L(p)},setValue:o=>{m(o),d("idle")},value:p}),S==="invalid"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-invalid-code-text",children:x.emailLoginScreen.invalidCode})]}),S==="linking_error"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-screen-error",children:k||"Failed to verify code"})]}),S==="payment_required"&&e.jsxs(ve,{children:[e.jsx(g,{y:"md"}),e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-screen-error",children:x.maxAccountsExceeded})]}),e.jsx(g,{y:"xl"}),e.jsx(h,{px:u?"xxl":"lg",children:S==="verifying"?e.jsx(h,{animate:"fadein",center:"x",flex:"row",children:e.jsx(le,{color:"accentText",size:"lg"})}):e.jsx(h,{animate:"fadein",children:e.jsx(Q,{onClick:()=>L(p),style:{width:"100%"},type:"submit",variant:"accent",className:"tw-verify-button",children:x.emailLoginScreen.verify})},"btn-container")}),e.jsx(g,{y:"xl"}),!u&&e.jsx(it,{}),e.jsxs(h,{gap:"sm",p:u?void 0:"lg",flex:"column",children:[w.type==="error"&&e.jsx(A,{center:!0,color:"danger",size:"sm",className:"tw-screen-error",children:w.message||x.emailLoginScreen.failedToSendCode}),w.type==="sending"&&e.jsxs(h,{center:"both",flex:"row",gap:"xs",style:{textAlign:"center"},children:[e.jsx(A,{size:"sm",children:x.emailLoginScreen.sendingCode}),e.jsx(le,{color:"secondaryText",size:"xs"})]}),w.type!=="sending"&&e.jsx(Wt,{onClick:y===0?F:void 0,style:{cursor:y>0?"default":"pointer",opacity:y>0?.5:1},className:"tw-resend-button",type:"button",children:y>0?`Resend code in ${y} seconds`:x.emailLoginScreen.resendCode})]})]})})]}):null}const Wt=at(t=>{const n=fe();return{all:"unset","&:hover":{color:n.colors.primaryText},color:n.colors.accentText,cursor:"pointer",fontSize:ze.sm,fontWeight:500,textAlign:"center",width:"100%"}});function _t(t){const{wallet:n,done:a,client:s,chain:r,size:u,locale:x}=t,[p,m]=i.useState("loading"),S=i.useRef(!1);return i.useEffect(()=>{S.current||(S.current=!0,st(s,te(n.id)?n.id:void 0).then(d=>{m(d?"login":"select")}).catch(()=>{m("select")}))},[s,n.id]),e.jsxs(h,{animate:"fadein",flex:"column",fullHeight:!0,children:[e.jsx(h,{p:"lg",children:e.jsx(se,{onBack:t.onBack,title:t.isLinking?x.passkeys.linkPasskey:x.passkeys.title})}),e.jsx(h,{center:"y",expand:!0,flex:"column",px:u==="wide"?"xxl":"lg",children:e.jsxs("div",{children:[p==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{}),e.jsx(g,{y:"xxl"})]}),p==="select"&&e.jsx(Mt,{onSignin:()=>{m("login")},onSignup:()=>{m("signup")}}),p==="login"&&e.jsx(Pt,{chain:r,client:s,done:a,isLinking:t.isLinking,onCreate:()=>{m("signup")},wallet:n}),p==="signup"&&e.jsx(Tt,{chain:r,client:s,done:a,isLinking:t.isLinking,wallet:n})]})})]})}function Pt(t){const{wallet:n,done:a,client:s,chain:r}=t,[u,x]=i.useState("loading"),[p,m]=i.useState();async function S(){x("loading");try{t.isLinking?await J({client:s,strategy:"passkey",type:"sign-in"}).catch(k=>{throw m(k.message),k}):(await n.connect({chain:r,client:s,strategy:"passkey",type:"sign-in"}),await X("passkey",ee)),a()}catch(k){console.error("Failed to login with passkey",k),x("error")}}const d=i.useRef(!1);return i.useEffect(()=>{d.current||(d.current=!0,S())}),u==="loading"?e.jsx(be,{icon:e.jsx(we,{size:oe.xxl}),subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",title:"Requesting Passkey"}):u==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:S,title:p||"Failed to Login"}),e.jsx(g,{y:"sm"}),e.jsx(Q,{fullWidth:!0,onClick:t.onCreate,variant:"outline",children:"Create a new Passkey"}),e.jsx(g,{y:"lg"})]}):null}function Tt(t){var v;const{wallet:n,done:a,client:s,chain:r}=t,[u,x]=i.useState(),[p,m]=i.useState("loading"),S=te(n)?{id:n.id,partnerId:(v=n.getConfig())==null?void 0:v.partnerId}:void 0;async function d(){m("loading");try{t.isLinking?await J({client:s,ecosystem:S,strategy:"passkey",type:"sign-up"}):(await n.connect({chain:r,client:s,strategy:"passkey",type:"sign-up"}),await X("passkey",ee)),a()}catch(w){console.error(w),w instanceof Error&&x(`Error creating passkey: ${w.message}`),m("error")}}const k=i.useRef(!1);return i.useEffect(()=>{k.current||(k.current=!0,d())}),p==="loading"?e.jsx(be,{icon:e.jsx(we,{size:oe.xxl}),subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",title:"Creating Passkey"}):p==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{onTryAgain:d,title:u||"Failed to create passkey"}),e.jsx(g,{y:"lg"})]}):null}function Mt(t){return e.jsxs(h,{children:[e.jsx(g,{y:"xxl"}),e.jsx(h,{center:"x",color:"accentText",flex:"row",children:e.jsx(we,{size:oe["4xl"]})}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Q,{fullWidth:!0,onClick:t.onSignup,variant:"accent",children:"Create a Passkey"}),e.jsx(g,{y:"sm"}),e.jsx(Q,{fullWidth:!0,onClick:t.onSignin,variant:"outline",children:"I have a Passkey"}),e.jsx(g,{y:"lg"})]})}function Ht(t){var b,y;const n=t.locale,a=n.socialLoginScreen,s=fe(),r=te(t.wallet)?{id:t.wallet.id,partnerId:(b=t.wallet.getConfig())==null?void 0:b.partnerId}:void 0,[u,x]=i.useState(void 0),{done:p,wallet:m}=t,[S,d]=i.useState("connecting"),k=async()=>{var O,F,$,G;const f=m.getConfig(),j=f&&"auth"in f?((O=f==null?void 0:f.auth)==null?void 0:O.mode)??"popup":"popup";if(f&&"auth"in f&&j!=="popup"&&!t.isLinking)return rt({authOption:t.socialAuth,client:t.client,ecosystem:r,mode:(F=f==null?void 0:f.auth)==null?void 0:F.mode,redirectUrl:($=f==null?void 0:f.auth)==null?void 0:$.redirectUrl});try{const L=lt({authOption:t.socialAuth,client:t.client,ecosystem:r,themeObj:s});if(!L)throw new Error(`Failed to open ${t.socialAuth} login window`);d("connecting"),t.isLinking?await J({client:t.client,closeOpenedWindow:B=>{B.close()},ecosystem:r,openedWindow:L,strategy:t.socialAuth}).catch(B=>{throw x(B.message),B}):await m.connect({chain:t.chain,client:t.client,closeOpenedWindow:B=>{B.close()},openedWindow:L,strategy:t.socialAuth}),await X(t.socialAuth,ee),d("connected"),p()}catch(L){d("error"),L instanceof Error&&((G=L==null?void 0:L.message)!=null&&G.includes("PAYMENT_METHOD_REQUIRED"))&&x(n.maxAccountsExceeded),console.error(`Error signing in with ${t.socialAuth}`,L)}},v=(y=t.state)==null?void 0:y.socialLogin,w=i.useRef(!1);return i.useEffect(()=>{w.current||v&&(w.current=!0,d("connecting"),v.connectionPromise.then(()=>{p(),d("connected")}).catch(f=>{x(f.message),d("error")}))},[p,v]),e.jsx(h,{animate:"fadein",flex:"column",fullHeight:!0,className:"tw-social-login-screen",children:e.jsxs(h,{expand:!0,flex:"column",p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(se,{onBack:t.goBack,title:t.isLinking?t.connectLocale.manageWallet.linkProfile:a.title}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(h,{center:"both",expand:!0,flex:"column",style:{minHeight:"250px",textAlign:"center"},children:[S!=="error"&&e.jsxs(h,{animate:"fadein",children:[e.jsx(A,{center:!0,color:"primaryText",multiline:!0,style:{maxWidth:"250px"},children:a.instruction}),e.jsx(g,{y:"xl"}),e.jsx(h,{center:"x",flex:"row",children:e.jsx(le,{color:"accentText",size:"lg"})}),e.jsx(g,{y:"xxl"})]}),S==="error"&&e.jsxs(h,{animate:"fadein",children:[u?e.jsx(A,{center:!0,color:"danger",children:u}):e.jsx(A,{color:"danger",children:a.failed}),e.jsx(g,{y:"lg"}),e.jsx(Q,{onClick:k,variant:"primary",children:a.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}export{Dt as G,Ft as O,_t as P,Ht as S,Ot as W};
